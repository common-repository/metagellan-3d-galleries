(()=>{"use strict";const e=window.React,l=window.wp.blocks,t=window.wp.blockEditor,n=window.wp.components,a=window.wp.element,r=window.wp.i18n,o=JSON.parse('{"u2":"metagellan-plugin/galleries"}');(0,l.registerBlockType)(o.u2,{icon:{src:(0,e.createElement)("svg",{preserveAspectRatio:"none",viewBox:"0 0 1200 1200",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)("path",{d:"M270.735 524.506C258.447 531.842 250.89 545.306 250.89 559.866V904.494C250.89 917.248 256.698 929.273 266.598 937.018L575.709 1191.59C590.049 1202.8 609.953 1202.8 624.293 1191.59L933.403 937.018C943.303 929.273 949.111 917.248 949.111 904.494V515.443C949.111 482.902 913.806 463.369 887.203 481.191L618.093 661.484C606.803 669.048 600.001 681.926 600.001 695.736V778.494V778.494C600.001 837.433 680.284 786.35 712.767 737.171L714.912 733.924C747.396 684.744 827.679 633.662 827.679 692.601V692.601V859.711C827.679 873.663 820.735 886.654 809.256 894.181L622.828 1029.16C609.043 1038.2 591.269 1037.73 577.96 1027.97L413.033 894.349C402.545 886.662 396.323 874.27 396.323 861.067V644.737C396.323 630.607 403.443 617.476 415.159 609.999L993.404 208.892C1020.05 191.891 1054.57 211.496 1054.57 243.63L997.285 746.504C997.285 779.991 1034.43 799.312 1060.86 779.573L1126.3 730.708C1136.62 723.001 1142.72 710.713 1142.72 697.639L1200 40.999C1200 9.40385 1166.51 -10.2817 1139.84 5.63829L270.735 524.506Z",fill:"#627E8B"}),(0,e.createElement)("path",{d:"M325.524 334.687C338.434 345.849 356.805 347.503 371.42 338.82L431.224 303.289C457.462 287.701 457.856 249.064 431.943 232.918L60.8004 17.6267C34.1446 1.01846 0 20.6555 0 52.5938L49.8107 707.927C49.8107 720.85 55.7734 733.015 65.8953 740.742L131.328 790.69C157.71 810.829 195.243 791.56 195.243 757.875L145.432 241.363C145.432 206.525 185.244 187.609 211.246 210.092L325.524 334.687Z",fill:"#E4A306"}))},edit:function(l){const{attributes:o,setAttributes:s}=l,[c,i]=(0,a.useState)(o.data),[u,m]=(0,a.useState)(null),[g,p]=(0,a.useState)(o.galleryUrl),[C,d]=(0,a.useState)(o.galleryName),[E,h]=(0,a.useState)(o.galleryUrl),w=(0,t.useBlockProps)({className:"wp-block-embed",style:{"background-color":"#fff",padding:"0.5em","border-radius":"2px","box-shadow":"inset 0 0 0 1px #1e1e1e","font-family":"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen-Sans, Ubuntu, Cantarell, Helvetica Neue, sans-serif"}}),b=(0,t.useBlockProps)({width:"100%",height:"1080px",src:`${g}`});return(0,e.createElement)(a.Fragment,null,(0,e.createElement)(t.BlockControls,null,(0,e.createElement)(n.ToolbarGroup,null,(0,e.createElement)(n.ToolbarButton,{icon:"edit-large",label:(0,r.__)("Edit","metagellan-3d-galleries"),onClick:()=>{h(null)}}))),(0,e.createElement)("div",{...w},!E&&(0,e.createElement)(a.Fragment,null,(0,e.createElement)("div",null,(0,e.createElement)("div",{className:"components-placeholder__label"},(0,e.createElement)("span",{class:"block-editor-block-icon has-colors"},(0,e.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 1200 1200",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)("path",{d:"M270.735 524.506C258.447 531.842 250.89 545.306 250.89 559.866V904.494C250.89 917.248 256.698 929.273 266.598 937.018L575.709 1191.59C590.049 1202.8 609.953 1202.8 624.293 1191.59L933.403 937.018C943.303 929.273 949.111 917.248 949.111 904.494V515.443C949.111 482.902 913.806 463.369 887.203 481.191L618.093 661.484C606.803 669.048 600.001 681.926 600.001 695.736V778.494V778.494C600.001 837.433 680.284 786.35 712.767 737.171L714.912 733.924C747.396 684.744 827.679 633.662 827.679 692.601V692.601V859.711C827.679 873.663 820.735 886.654 809.256 894.181L622.828 1029.16C609.043 1038.2 591.269 1037.73 577.96 1027.97L413.033 894.349C402.545 886.662 396.323 874.27 396.323 861.067V644.737C396.323 630.607 403.443 617.476 415.159 609.999L993.404 208.892C1020.05 191.891 1054.57 211.496 1054.57 243.63L997.285 746.504C997.285 779.991 1034.43 799.312 1060.86 779.573L1126.3 730.708C1136.62 723.001 1142.72 710.713 1142.72 697.639L1200 40.999C1200 9.40385 1166.51 -10.2817 1139.84 5.63829L270.735 524.506Z",fill:"#627E8B"}),(0,e.createElement)("path",{d:"M325.524 334.687C338.434 345.849 356.805 347.503 371.42 338.82L431.224 303.289C457.462 287.701 457.856 249.064 431.943 232.918L60.8004 17.6267C34.1446 1.01846 0 20.6555 0 52.5938L49.8107 707.927C49.8107 720.85 55.7734 733.015 65.8953 740.742L131.328 790.69C157.71 810.829 195.243 791.56 195.243 757.875L145.432 241.363C145.432 206.525 185.244 187.609 211.246 210.092L325.524 334.687Z",fill:"#E4A306"}))),"Metagellan - 3D virtual galleries on your website")),(0,e.createElement)(n.TextControl,{label:(0,r.__)("Enter User ID","metagellan-3d-galleries"),value:o.userId,onChange:e=>s({userId:e})}),(0,e.createElement)(n.TextControl,{label:"Enter Access Token",value:o.token,onChange:e=>s({token:e})}),(0,e.createElement)(n.SelectControl,{label:"Select Language",value:o.culture,options:[{label:"English",value:"183"},{label:"FranÃ§ais",value:"67"}],onChange:e=>s({culture:e})}),(0,e.createElement)("div",null,(0,e.createElement)("button",{className:"components-button is-primary alignright ",onClick:()=>function(){const e=o.userId,l=o.token,t=o.culture;i(null),m(null),36!=e.length?m("Wrong User ID"):36!=l.length?m("Wrong token"):fetch(`https://api.colleconline.com/public/users/${e}/galleries?token=${l}&culture=${t}`,{method:"GET"}).then((e=>e.ok?e.json():(401==e.status?m("Wrong token or upgrade your plan"):404==e.status?m("Wrong user"):m("Error"),Promise.reject(e.status)))).then((e=>{let l={...e};i(function(e){let l=[];return e.galleries.map((e=>{const t=new Map([["label",e.name],["value",e.url]]),n=Object.fromEntries(t);l.push(n)})),p(l[0].value),d(l[0].label),s({data:l}),l}(l))}))}()},(0,r.__)("Import your galleries","metagellan-3d-galleries"))),c&&(0,e.createElement)(a.Fragment,null,(0,e.createElement)("p",null,(0,e.createElement)(n.SelectControl,{label:(0,r.__)("Select gallery to embed","metagellan-3d-galleries"),value:g,options:c,onChange:e=>function(e){p(e),c.map((l=>{l.value==e&&d(l.label)}))}(e),className:"components-placeholder__input"}),(0,e.createElement)("div",{className:"alignright"},(0,e.createElement)("button",{className:"components-button is-primary",onClick:()=>(m(null),s({galleryUrl:g}),s({galleryName:C}),void h("Saved"))},"Add Gallery")))),u&&(0,e.createElement)(a.Fragment,null,(0,e.createElement)("p",null,"Error: ",u))),E&&(0,e.createElement)(a.Fragment,null,(0,e.createElement)("iframe",{...b}))))},save:function({attributes:l}){if(void 0===l.galleryUrl||null===l.galleryUrl)return;const n=l.galleryUrl,a=t.useBlockProps.save({style:"width:100%; height:100%;"}),r=t.useBlockProps.save({width:"100%",height:"1080px",src:`${n}`,allowfullscreen:"allowfullscreen",style:"width:100%; height:80vh;"});return(0,e.createElement)("div",{...a},(0,e.createElement)("iframe",{...r}))},attributes:{data:{type:"array"},galleryUrl:{type:"string"},galleryName:{type:"string"},userId:{type:"string"},token:{type:"string"},culture:{type:"string"}}})})();